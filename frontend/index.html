<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Lapa Casa Hostel – Reservas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <!-- API base + Stripe key -->
  <meta name="backend-base-url" content="https://api.lapacasahostel.com/api"/>
  <meta name="stripe-publishable-key" content="pk_live_o_test"/>
  <link rel="stylesheet" href="/styles.css"/>
  <script src="https://js.stripe.com/v3/" defer></script>
  <script src="/main.js" defer></script>
</head>
<body>
  <header>
    <h1>Lapa Casa Hostel – Reservas</h1>
    <nav class="lang">
      <a href="#/book">Reservas</a>
      <a href="#/admin">Admin</a>
    </nav>
  </header>

  <main class="row">
    <!-- BOOK -->
    <section id="book" class="card">
      <!-- Fechas y cantidad -->
      <div class="grid grid-2">
        <div>
          <label>Check-in</label>
          <input id="dateIn" type="date"/>
        </div>
        <div>
          <label>Check-out</label>
          <input id="dateOut" type="date"/>
        </div>
      </div>

      <div class="grid grid-4" style="margin-top:10px">
        <div>
          <label>Hombres</label>
          <div class="ctr">
            <button type="button" id="menMinus">−</button>
            <input id="men" type="number" min="0" max="38" value="0" />
            <button type="button" id="menPlus">+</button>
          </div>
        </div>
        <div>
          <label>Mujeres</label>
          <div class="ctr">
            <button type="button" id="womenMinus">−</button>
            <input id="women" type="number" min="0" max="38" value="0" />
            <button type="button" id="womenPlus">+</button>
          </div>
        </div>
        <div class="muted" style="display:flex;align-items:end">Capacidad total: 38</div>
        <div style="display:flex;justify-content:end;align-items:end">
          <button id="checkAvail" class="btn" type="button">Ver disponibilidad</button>
        </div>
      </div>
      <div id="checkMsg" class="muted" style="margin-top:6px"></div>

      <!-- Rooms -->
      <section id="roomsCard" class="card" style="display:none">
        <h2>Elegí tus camas</h2>
        <div id="mods" class="muted" style="margin-bottom:8px"></div>
        <div id="rooms" class="rooms"></div>
        <div class="actions" style="margin-top:8px">
          <div>
            <div>Seleccionadas: <span id="selCount">0</span> de <span id="needed">0</span></div>
            <div class="muted">Total: R$ <span id="totalPrice">0</span></div>
          </div>
          <button id="continueBtn" class="btn" disabled type="button">Continuar</button>
        </div>
        <p class="warning" id="suggestBox"></p>
      </section>

      <!-- Formulario -->
      <section id="formCard" class="card" style="display:none">
        <h2>Datos para confirmar</h2>
        <form id="reserva-form">
          <label>Nombre completo</label>
          <input type="text" name="nombre" required/>
          <label>Email</label>
          <input type="email" name="email" required/>
          <label>Teléfono</label>
          <input type="tel" name="telefono" required/>
          <label>Fecha de entrada</label>
          <input type="date" name="entrada" required/>
          <label>Fecha de salida</label>
          <input type="date" name="salida" required/>
          <label style="margin-top:8px">
            <input type="checkbox" id="consentChk"/>
            <span class="muted">Acepto recibir comunicaciones y la política de privacidad.</span>
          </label>

          <div class="grid grid-2" style="margin-top:10px">
            <div class="card">
              <h3>Mercado Pago (Checkout Pro)</h3>
              <p class="muted">Pix / tarjeta / boleto</p>
              <button type="button" id="payMP" class="btn secondary">Pagar con MP</button>
            </div>
            <div class="card">
              <h3>Pix directo (QR)</h3>
              <p class="muted">Siempre muestra QR</p>
              <button type="button" id="payPix" class="btn ghost">Pix (QR)</button>
            </div>
          </div>

          <div class="card" style="margin-top:10px">
            <h3>Stripe</h3>
            <p class="muted">Tarjeta internacional</p>
            <button type="button" id="payStripe" class="btn secondary">Ir a Checkout</button>
          </div>

          <div class="actions" style="margin-top:12px">
            <span class="muted">Estado pago: <span id="payState" class="highlight">pendiente</span></span>
            <button type="submit" id="submitBtn" class="btn" disabled>Confirmar reserva</button>
          </div>
        </form>
      </section>
    </section>

    <!-- ADMIN -->
    <section id="admin" class="card" style="display:none">
      <h2>Admin</h2>
      <label>Token</label>
      <input id="admToken" type="text" />
      <button id="btnHealth" class="btn">Health</button>
      <pre id="healthOut"></pre>

      <h3>Holds</h3>
      <button id="btnHolds" class="btn">Listar Holds</button>
      <div id="holdsOut"></div>

      <h3>Bookings</h3>
      <div class="grid grid-3">
        <input id="bkFrom" type="date" />
        <input id="bkTo" type="date" />
        <input id="bkQ" type="text" placeholder="Buscar" />
      </div>
      <button id="btnBookings" class="btn">Buscar</button>
      <div id="bookingsOut"></div>
    </section>
  </main>

  <footer><p class="muted">&copy; 2025 Lapa Casa Hostel</p></footer>
</body>
</html>
